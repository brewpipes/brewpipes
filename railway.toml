# Railway deployment configuration for BrewPipes
# https://docs.railway.app/reference/config-as-code
#
# This file exists only on the deploy-railway branch.
# To deploy: merge main into deploy-railway and push.

[build]
builder = "DOCKERFILE"
dockerfilePath = "cmd/monolith/Dockerfile"

# Rebuild when these paths change
watchPatterns = [
  "cmd/**",
  "internal/**",
  "service/**",
  "go.mod",
  "go.sum"
]

[deploy]
numReplicas = 1
healthcheckPath = "/api/health"
healthcheckTimeout = 30
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

# Required environment variables (set in Railway dashboard):
#   POSTGRES_DSN         - Database connection string (use ${{Postgres.DATABASE_URL}})
#   BREWPIPES_SECRET_KEY - JWT signing key (generate with: openssl rand -base64 32)
