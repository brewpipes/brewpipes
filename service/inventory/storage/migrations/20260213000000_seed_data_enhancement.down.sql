-- Reverse seed data enhancement: remove all records inserted by the up migration.
BEGIN;

-- Remove inventory movements (reverse dependency order)
-- Zero-stock usage movement
DELETE FROM inventory_movement WHERE usage_id = (SELECT id FROM inventory_usage WHERE uuid = '83000000-0000-0000-0000-000000000010');

-- Beer lot movements
DELETE FROM inventory_movement WHERE beer_lot_id IN (
    (SELECT id FROM beer_lot WHERE uuid = '86000000-0000-0000-0000-000000000001'),
    (SELECT id FROM beer_lot WHERE uuid = '86000000-0000-0000-0000-000000000002')
) AND receipt_id IN (
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000020'),
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000021')
);

-- Waste movement
DELETE FROM inventory_movement WHERE adjustment_id = (SELECT id FROM inventory_adjustment WHERE uuid = '84000000-0000-0000-0000-000000000007');

-- Adjustment movements
DELETE FROM inventory_movement WHERE adjustment_id IN (
    (SELECT id FROM inventory_adjustment WHERE uuid = '84000000-0000-0000-0000-000000000003'),
    (SELECT id FROM inventory_adjustment WHERE uuid = '84000000-0000-0000-0000-000000000004'),
    (SELECT id FROM inventory_adjustment WHERE uuid = '84000000-0000-0000-0000-000000000005'),
    (SELECT id FROM inventory_adjustment WHERE uuid = '84000000-0000-0000-0000-000000000006')
);

-- Receive movements for new lots
DELETE FROM inventory_movement WHERE ingredient_lot_id IN (
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000020'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000021'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000022'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000023'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000024'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000025'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000026'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000027'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000028'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000029'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000030'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000031'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000032'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000033'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000034'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000035'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000036'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000040'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000041'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000050'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000051'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000052')
) AND receipt_id IN (
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000010'),
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000011'),
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000012'),
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000013'),
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000014'),
    (SELECT id FROM inventory_receipt WHERE uuid = '82000000-0000-0000-0000-000000000015')
);

-- Remove usage record
DELETE FROM inventory_usage WHERE uuid = '83000000-0000-0000-0000-000000000010';

-- Remove adjustments
DELETE FROM inventory_adjustment WHERE uuid IN (
    '84000000-0000-0000-0000-000000000003',
    '84000000-0000-0000-0000-000000000004',
    '84000000-0000-0000-0000-000000000005',
    '84000000-0000-0000-0000-000000000006',
    '84000000-0000-0000-0000-000000000007'
);

-- Remove lot detail records
DELETE FROM ingredient_lot_yeast_detail WHERE ingredient_lot_id IN (
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000020'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000021'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000022'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000023'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000024')
);

DELETE FROM ingredient_lot_hop_detail WHERE ingredient_lot_id IN (
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000025'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000026'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000027'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000028'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000029'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000041'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000051')
);

DELETE FROM ingredient_lot_malt_detail WHERE ingredient_lot_id IN (
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000032'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000033'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000034'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000035'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000036'),
    (SELECT id FROM ingredient_lot WHERE uuid = '80000000-0000-0000-0000-000000000040')
);

-- Remove ingredient lots
DELETE FROM ingredient_lot WHERE uuid IN (
    '80000000-0000-0000-0000-000000000020',
    '80000000-0000-0000-0000-000000000021',
    '80000000-0000-0000-0000-000000000022',
    '80000000-0000-0000-0000-000000000023',
    '80000000-0000-0000-0000-000000000024',
    '80000000-0000-0000-0000-000000000025',
    '80000000-0000-0000-0000-000000000026',
    '80000000-0000-0000-0000-000000000027',
    '80000000-0000-0000-0000-000000000028',
    '80000000-0000-0000-0000-000000000029',
    '80000000-0000-0000-0000-000000000030',
    '80000000-0000-0000-0000-000000000031',
    '80000000-0000-0000-0000-000000000032',
    '80000000-0000-0000-0000-000000000033',
    '80000000-0000-0000-0000-000000000034',
    '80000000-0000-0000-0000-000000000035',
    '80000000-0000-0000-0000-000000000036',
    '80000000-0000-0000-0000-000000000040',
    '80000000-0000-0000-0000-000000000041',
    '80000000-0000-0000-0000-000000000050',
    '80000000-0000-0000-0000-000000000051',
    '80000000-0000-0000-0000-000000000052'
);

-- Remove receipts
DELETE FROM inventory_receipt WHERE uuid IN (
    '82000000-0000-0000-0000-000000000010',
    '82000000-0000-0000-0000-000000000011',
    '82000000-0000-0000-0000-000000000012',
    '82000000-0000-0000-0000-000000000013',
    '82000000-0000-0000-0000-000000000014',
    '82000000-0000-0000-0000-000000000015',
    '82000000-0000-0000-0000-000000000020',
    '82000000-0000-0000-0000-000000000021'
);

-- Remove ingredient detail records
DELETE FROM ingredient_yeast_detail WHERE ingredient_id IN (
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000020'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000021'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000022'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000023'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000024')
);

DELETE FROM ingredient_hop_detail WHERE ingredient_id IN (
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000025'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000026'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000027'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000028'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000029')
);

DELETE FROM ingredient_malt_detail WHERE ingredient_id IN (
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000032'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000033'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000034'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000035'),
    (SELECT id FROM ingredient WHERE uuid = '70000000-0000-0000-0000-000000000036')
);

-- Remove ingredients
DELETE FROM ingredient WHERE uuid IN (
    '70000000-0000-0000-0000-000000000017',
    '70000000-0000-0000-0000-000000000018',
    '70000000-0000-0000-0000-000000000019',
    '70000000-0000-0000-0000-000000000020',
    '70000000-0000-0000-0000-000000000021',
    '70000000-0000-0000-0000-000000000022',
    '70000000-0000-0000-0000-000000000023',
    '70000000-0000-0000-0000-000000000024',
    '70000000-0000-0000-0000-000000000025',
    '70000000-0000-0000-0000-000000000026',
    '70000000-0000-0000-0000-000000000027',
    '70000000-0000-0000-0000-000000000028',
    '70000000-0000-0000-0000-000000000029',
    '70000000-0000-0000-0000-000000000030',
    '70000000-0000-0000-0000-000000000031',
    '70000000-0000-0000-0000-000000000032',
    '70000000-0000-0000-0000-000000000033',
    '70000000-0000-0000-0000-000000000034',
    '70000000-0000-0000-0000-000000000035',
    '70000000-0000-0000-0000-000000000036'
);

COMMIT;
